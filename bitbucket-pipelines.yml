pipelines:
  default:
    - step:
        script:
          - echo "This script runs on all branches that don't have any specific pipeline assigned in 'branches'.\n"
  branches:
    master:
      - step:
          script:
            - printf "This script runs only on commit to the MASTER branch.\n"
            - uname -a
            - free -m
            - df -H
            - netstat -apn
            - docker info
            - npm -v
            - printf "Everything is awesome!\n";
    dev-1.0.2:
      - step:
          script:
            - printf "[Step_1] This script runs only on commit to the [${BITBUCKET_BRANCH}] branch.\n"
            - uname -a
            - pwd
      - step:
          script:
            - printf "[Step_2] This script runs only on commit to the [${BITBUCKET_BRANCH}] branch.\n"
            - apt-get update -y
            - apt -y install php5 php5-cli php5-common
            - php -v
            - make
            - make dev
            # - ./setup.sh test --env=production
            # - ./setup.sh prepare --env=production
            # - ./setup.sh build --env=production
            # - ./setup.sh deploy --env=production
      - step:
          script:
            - printf "[Step_3] This script runs only on commit to the [${BITBUCKET_BRANCH}] branch.\n"
            - make prod
            - printf "Everything is awesome!\n";
